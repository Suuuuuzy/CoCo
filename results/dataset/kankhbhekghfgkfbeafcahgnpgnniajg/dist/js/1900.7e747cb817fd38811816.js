(self.webpackChunknewtab=self.webpackChunknewtab||[]).push([[1900],{1900:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Draggable:()=>n});class n{constructor(t={}){this.options={selector:null,onDown:(t,e)=>{},onMove:(t,e)=>{},onUp:(t,e)=>{},onMergeEnter:(t,e,i)=>{},onMergeOut:(t,e,i)=>{},onMerge:(t,e,i)=>{},grid:null,snap:!1,stayTime:1e3,mergeAllow:!0,inElement:null,inElementPadding:0,isCancelDefaultEvent:!0,zIndex:999},this.options=Object.assign(this.options,t),this.offsetX=0,this.offsetY=0,this.clientX=0,this.clientY=0,this.currentClientX=0,this.currentClientY=0,this.timeout=null,this.dragging=!1,this.merging=!1,this.inElement=this.options.inElement,this.supportTouchEvent()?this.eventTypes={down:"touchstart",up:"touchend",move:"touchmove"}:this.eventTypes={down:"mousedown",up:"mouseup",move:"mousemove"},this.activeElement=null,this.targetElement=null,this.options.selector?this.initEvents():this.elements=[]}initEvents(){this.elements=[],this.options.selector instanceof Node?this.elements.push(this.options.selector):this.options.selector instanceof NodeList?this.elements=this.options.selector:this.elements=document.querySelectorAll(this.options.selector),this.nodeListToArray(),this.elements.forEach((t=>{t.addEventListener(this.eventTypes.down,(t=>this.downEvent(t)))}))}nodeListToArray(){const t=[];this.elements instanceof NodeList&&(this.elements.forEach((e=>{t.push(e)})),this.elements=t)}addElement(t){t.addEventListener(this.eventTypes.down,(t=>this.downEvent(t))),this.elements.push(t)}downEvent(t){if(1!=t.which)return;const e=t.currentTarget;let i=e.getAttribute("data-target");this.activeElement=i?document.getElementById(i):e,this.setPositionAll(),this.dragging=!0,"mousedown"==t.type&&this.options.isCancelDefaultEvent&&this.cancelDefaultEvent(t);const n=this.activeElement.getBoundingClientRect();let s=t.touches?t.touches[0]:t;this.clientX=s.clientX,this.clientY=s.clientY,this.offsetX=n.left,this.offsetY=n.top;let o=this;this.activeElement.style.position="fixed",this.activeElement.style.zIndex=this.options.zIndex,this.activeElement.style.margin="0",this.activeElement.style.left=n.left+"px",this.activeElement.style.top=n.top+"px";let l=function(t){return o.moveEvent(t)};document.addEventListener(this.eventTypes.move,l);let h=function(t){return document.removeEventListener(o.eventTypes.move,l),document.removeEventListener(o.eventTypes.up,h),o.upEvent(t)};document.addEventListener(this.eventTypes.up,h),this.options.onDown(this.activeElement,t)}_isMerge(t,e,i){const n=t.getBoundingClientRect();return e>n.left&&e<n.right&&i>n.top&&i<n.bottom}setPositionAll(){this.elements.forEach(((t,e)=>{t.sort=e}))}moveEvent(t){let e=t.touches?t.touches[0]:t,i=e.clientX-this.clientX,n=e.clientY-this.clientY;if(i+=this.offsetX,n+=this.offsetY,this.inElement){const t=this.inElement.getBoundingClientRect(),e=this.activeElement.getBoundingClientRect();let s=t.left+this.options.inElementPadding,o=t.right-e.width-this.options.inElementPadding;i<s&&(i=s),i>o&&(i=o);let l=t.top+this.options.inElementPadding,h=t.bottom-e.height-this.options.inElementPadding;n<l&&(n=l),n>h&&(n=h)}if(!this.options.snap&&this.options.grid){let t=void 0!==this.options.grid.x,s=void 0!==this.options.grid.y;t&&this.options.grid.x>0&&(i=this.options.grid.x*Math.round((this.offsetX+(e.clientX-this.clientX))/this.options.grid.x)),s&&this.options.grid.y>0&&(n=this.options.grid.x*Math.round((this.offsetY+(e.clientY-this.clientY))/this.options.grid.x))}if(this.activeElement.style.top=n+"px",this.activeElement.style.left=i+"px",this.options.mergeAllow&&this.dragging){this.currentClientX=e.clientX,this.currentClientY=e.clientY;let i=!1;for(let e=0;e<this.elements.length;e++){const n=this.elements[e];if(this.activeElement!=n){if(this._isMerge(n,this.currentClientX,this.currentClientY)){if(i=!0,this.targetElement==this.activeElement||this.targetElement==n)break;this.targetElement=n,this.timeout||(this.timeout=setTimeout((()=>{clearTimeout(this.timeout),this.timeout=null,this.dragging&&this.targetElement&&this._isMerge(this.targetElement,this.currentClientX,this.currentClientY)&&(this.merging=!0,this.options.onMergeEnter(this.activeElement,this.targetElement,t))}),this.options.stayTime));break}this.targetElement=null,i=!1}}i||(this.targetElement=null,this.merging&&(this.merging=!1,this.options.onMergeOut(this.activeElement,this.targetElement,t)))}this.options.onMove(this.activeElement,t)}upEvent(t){let e=t.changedTouches?t.changedTouches[0]:t;if(this.dragging=!1,"mouseup"==t.type&&this.options.isCancelDefaultEvent&&this.cancelDefaultEvent(t),this.options.snap&&this.options.grid){let t=this.activeElement.offsetLeft-this.activeElement.offsetLeft%this.options.grid.x,e=this.activeElement.offsetTop-this.activeElement.offsetTop%this.options.grid.y;this.activeElement.style.left=t+"px",this.activeElement.style.top=e+"px"}if(this.options.mergeAllow&&this.merging&&(this.merging=!1,this.options.onMerge(this.activeElement,this.targetElement,e)),this.activeElement.style.position="absolute",this.inElement){const t=this.inElement.getBoundingClientRect();let e=parseInt(this.activeElement.style.left)-t.left,i=parseInt(this.activeElement.style.top)-t.top;"static"!=getComputedStyle(this.inElement).getPropertyValue("position")?(e-=this.inElement.clientLeft,i-=this.inElement.clientTop,this.activeElement.style.left=e+"px",this.activeElement.style.top=i+"px"):this.isStaticPosition(this.inElement)||(this.activeElement.style.left=e+"px",this.activeElement.style.top=i+"px")}this.options.onUp(this.activeElement,t),this.activeElement=null,this.targetElement=null}isStaticPosition(t){return!t.offsetParent||"static"==getComputedStyle(t.offsetParent).getPropertyValue("position")&&this.isStaticPosition(t.offsetParent)}supportTouchEvent(){let t=!0;try{document.createEvent("TouchEvent")}catch(e){t=!1}return t}cancelDefaultEvent(t){t.preventDefault(),t.stopPropagation()}}}}]);