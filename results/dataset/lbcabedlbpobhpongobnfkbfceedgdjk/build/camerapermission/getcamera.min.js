var runtimePort=chrome.runtime.connect({name:location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join("")});function enableCamera(e,t,i){var a={};i?(a.video={aspectRatio:1},document.getElementById("outklip-live-video-viewer-id").classList.remove(["outklip-natural-aspect-ratio-video"]),document.getElementById("outklip-live-video-viewer-id").classList.add(["outklip-square-aspect-ratio-video"])):(a.video={},document.getElementById("outklip-live-video-viewer-id").classList.remove(["outklip-square-aspect-ratio-video"]),document.getElementById("outklip-live-video-viewer-id").classList.add(["outklip-natural-aspect-ratio-video"])),t&&(a.video.deviceId=t),navigator.mediaDevices.getUserMedia(a).then(function(e){document.getElementById("outklip-live-video-viewer-id").srcObject=e,window.outklipstream=e,window.top.postMessage({cameraIsOn:!0},"*")}).catch(function(t){console.log(t),window.top.postMessage({cameraSetupError:!0,requesttype:e},"*")})}function getParamValue(e){for(var t=window.location.search.substring(1),i=t?t.split("&"):[],a=0;a<i.length;a++){var o=i[a].split("=");if(o[0]==e)return o[1]}return null}window.addEventListener("message",function(e){e.source==window.top&&(e.data.type&&"ENABLE_CAMERA"==e.data.type?(window.outklipstream&&(window.outklipstream.getVideoTracks()[0].stop(),window.outklipstream=null),enableCamera(e.data.requesttype,e.data.cameradeviceid,e.data.squareaspectratio),e.data.width&&(document.getElementById("outklip-live-video-viewer-id").style.width=e.data.width),e.data.height&&(document.getElementById("outklip-live-video-viewer-id").style.height=e.data.height)):e.data.type&&"DISABLE_CAMERA"==e.data.type?(window.outklipstream&&(window.outklipstream.getVideoTracks()[0].stop(),window.outklipstream=null),document.getElementById("outklip-live-video-viewer-id").srcObject=null,window.top.postMessage({cameraIsOn:!1},"*")):e.data.type&&"CHANGE_SIZE"==e.data.type?(document.getElementById("outklip-live-video-viewer-id").style.width=e.data.width,document.getElementById("outklip-live-video-viewer-id").style.height=e.data.height):e.data.type&&"GET_CAMERA_DEVICES"==e.data.type&&navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=[],i=0;i<e.length;i++)"videoinput"===e[i].kind&&t.push({id:e[i].deviceId,label:e[i].label||"Camera "+(t.length+1)});window.top.postMessage({listOfCameraInputDevices:t},"*")}).catch(function(e){console.log(e),window.top.postMessage({cameraSetupError:!0,requesttype:requestType},"*")}))},!1),enableCamera("auto",getParamValue("cameradeviceid"),"true"==getParamValue("squareaspectratio"));